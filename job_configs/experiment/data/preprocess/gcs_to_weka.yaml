version: v2
budget: ai2/oe-data
description: Sync contents of GCS bucket huongn-openwhisper to WEKA bucket oe-data-default
tasks:
  - name: hyak_to_weka_gcs
    image:
      beaker: huongn/hyak_to_weka_gcs
    command: ['/bin/bash', '-c']
    arguments: ['gcloud auth activate-service-account remote-sensing-data-hub@ai2-vision.iam.gserviceaccount.com --key-file="/root/gcp_service_key.json" &&
    gsutil -m cp -L /data/huongn/hyak_to_weka/gcs.log -r gs://huongn-openwhisper/* /oe-data-default/huongn/ow_440K_wds/']
    datasets:
    - mountPath: /oe-data-default
      source:
        weka: oe-data-default
    - mountPath: /root/gcp_service_key.json
      source:
        secret: gcp-secret
    result:
      path: /data/huongn/hyak_to_weka
    context:
      preemptible: true
    constraints:
      cluster:
        - ai2/jupiter-cirrascale-2